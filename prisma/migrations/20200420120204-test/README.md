# Migration `20200420120204-test`

This migration has been generated by Patrik FasÌŒang at 4/20/2020, 12:02:04 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "default$default"."Activity" DROP CONSTRAINT IF EXiSTS "Activity_project_fkey",
DROP CONSTRAINT IF EXiSTS "Activity_user_fkey",
DROP COLUMN "project",
DROP COLUMN "user",
ADD COLUMN "projectId" text  NOT NULL ,
ADD COLUMN "userId" text  NOT NULL ;

ALTER TABLE "default$default"."ActivitySkill" DROP CONSTRAINT IF EXiSTS "ActivitySkill_owner_fkey",
DROP CONSTRAINT IF EXiSTS "ActivitySkill_skill_fkey",
DROP COLUMN "owner",
DROP COLUMN "skill",
ADD COLUMN "ownerId" text  NOT NULL ,
ADD COLUMN "skillId" text  NOT NULL ;

ALTER TABLE "default$default"."Project" DROP CONSTRAINT IF EXiSTS "Project_manager_fkey",
DROP COLUMN "manager",
ADD COLUMN "managerId" text  NOT NULL ;

ALTER TABLE "default$default"."UserSkill" DROP CONSTRAINT IF EXiSTS "UserSkill_owner_fkey",
DROP CONSTRAINT IF EXiSTS "UserSkill_skill_fkey",
DROP COLUMN "owner",
DROP COLUMN "skill",
ADD COLUMN "ownerId" text  NOT NULL ,
ADD COLUMN "skillId" text  NOT NULL ;

ALTER TABLE "default$default"."Activity" ADD FOREIGN KEY ("projectId")REFERENCES "default$default"."Project"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."Activity" ADD FOREIGN KEY ("userId")REFERENCES "default$default"."Profile"("user") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."ActivitySkill" ADD FOREIGN KEY ("ownerId")REFERENCES "default$default"."Activity"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."ActivitySkill" ADD FOREIGN KEY ("skillId")REFERENCES "default$default"."Skill"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."Project" ADD FOREIGN KEY ("managerId")REFERENCES "default$default"."Profile"("user") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."UserSkill" ADD FOREIGN KEY ("skillId")REFERENCES "default$default"."Skill"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."UserSkill" ADD FOREIGN KEY ("ownerId")REFERENCES "default$default"."Profile"("user") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER INDEX "default$default"."default$default.Project.name._UNIQUE" RENAME TO "Project.name"

ALTER INDEX "default$default"."default$default.Skill.name._UNIQUE" RENAME TO "Skill.name"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200420120204-test
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,67 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model Activity {
+  id            String          @id @default(cuid())
+  name          String
+  startDate     DateTime
+  endDate       DateTime?
+  project       Project        @relation(fields: [projectId], references: [id])
+  projectId     String
+  user          Profile        @relation(fields: [userId], references: [user])
+  userId        String
+  skills        ActivitySkill[]
+}
+
+model ActivitySkill {
+  id        String    @id @default(cuid())
+  level     Int
+  owner     Activity @relation(fields: [ownerId], references: [id])
+  ownerId   String
+  skill     Skill    @relation(fields: [skillId], references: [id])
+  skillId   String
+}
+
+model Profile {
+  user      String     @id @default(cuid())
+  firstName String
+  lastName  String
+  title     String?
+  activities Activity[]
+  skills    UserSkill[]
+  createdAt DateTime
+  updatedAt DateTime
+}
+
+model Project {
+  id          String     @id @default(cuid())
+  name        String     @unique
+  description String
+  manager     Profile   @relation(fields: [managerId], references: [user])
+  managerId   String
+  startDate   DateTime
+  endDate     DateTime?
+  activities  Activity[]
+}
+
+model Skill {
+  id            String          @id @default(cuid())
+  name          String          @unique
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+}
+
+model UserSkill {
+  id      String   @id @default(cuid())
+  level   Int
+  skill   Skill   @relation(fields: [skillId], references: [id])
+  skillId String
+  owner   Profile @relation(fields: [ownerId], references: [user])
+  ownerId String
+}
```


